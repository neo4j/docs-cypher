[[cypher-deprecations-additions-removals-compatibility]]
= Deprecations, additions and compatibility
:description: Cypher is a language that is constantly evolving. New features get added to the language continuously, and occasionally, some features become deprecated and are subsequently removed. 

* xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals[Removals, deprecations, additions and extensions]
 ** xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals-3.0[Version 3.0]
 ** xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals-3.1[Version 3.1]
 ** xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals-3.2[Version 3.2]
 ** xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals-3.3[Version 3.3]
 ** xref:deprecations-additions-removals-compatibility.adoc#cypher-deprecations-additions-removals-3.4[Version 3.4]
* xref:deprecations-additions-removals-compatibility.adoc#cypher-compatibility[Compatibility]
* xref:deprecations-additions-removals-compatibility.adoc#cypher-versions[Supported language versions]


[[cypher-deprecations-additions-removals]]
== Removals, deprecations, additions and extensions

The following tables lists all the features which have been removed, deprecated, added or extended in Cypher.
Replacement syntax for deprecated and removed features are also indicated.


[[cypher-deprecations-additions-removals-3.0]]
=== Version 3.0
[options="header"]
|===
| Feature          | Type | Change | Details
| `has()`  | Function  | Removed | Replaced by xref:functions/predicate.adoc#functions-exists[exists()]
| `str()`  | Function  | Removed | Replaced by xref:functions/string.adoc#functions-tostring[toString()]
| `+{parameter}+` | Syntax | Deprecated | Replaced by xref:syntax/parameters.adoc[$parameter]
| xref:functions/scalar.adoc#functions-properties[properties()]  | Function  | Added  |
| xref:clauses/call.adoc[CALL [\...YIELD\]]   | Clause  | Added  |
| xref:functions/spatial.adoc#functions-point-cartesian-2d[point() - Cartesian 2D] | Function | Added |
| xref:functions/spatial.adoc#functions-point-wgs84-2d[point() - WGS 84 2D] | Function | Added |
| xref:functions/spatial.adoc#functions-distance[distance()] | Function | Added |
| link:{neo4j-docs-base-uri}/java-reference/{page-version}/extending-neo4j/procedures#extending-neo4j-procedures[User-defined procedures] | Functionality | Added |
| xref:functions/string.adoc#functions-tostring[toString()]   | Function  | Extended | Now also allows Boolean values as input
|===


[[cypher-deprecations-additions-removals-3.1]]
=== Version 3.1
[options="header"]
|===
| Feature          | Type | Change | Details
| `rels()`   | Function  | Deprecated | Replaced by xref:functions/list.adoc#functions-relationships[relationships()]
| `toInt()`   | Function  | Deprecated | Replaced by xref:functions/scalar.adoc#functions-tointeger[toInteger()]
| `lower()`   | Function  | Deprecated | Replaced by xref:functions/string.adoc#functions-tolower[toLower()]
| `upper()`   | Function  | Deprecated | Replaced by xref:functions/string.adoc#functions-toupper[toUpper()]
| xref:functions/scalar.adoc#functions-toboolean[toBoolean()] | Function | Added |
| xref:syntax/maps.adoc#cypher-map-projection[Map projection] | Syntax | Added |
| xref:syntax/lists.adoc#cypher-pattern-comprehension[Pattern comprehension] | Syntax | Added |
| link:{neo4j-docs-base-uri}/java-reference/{page-version}/extending-neo4j/functions#extending-neo4j-functions[User-defined functions] | Functionality | Added |
| xref:clauses/call.adoc[CALL\...YIELD\...WHERE]   | Clause  | Extended  | Records returned by `YIELD` may be filtered further using `WHERE`
|===


[[cypher-deprecations-additions-removals-3.2]]
=== Version 3.2
[options="header"]
|===
| Feature          | Type | Change | Details
| `CYPHER planner=rule` (Rule planner)    | Functionality | Removed | All queries now use the cost planner. Any query prepended thus will fall back to using Cypher 3.1.
| `CREATE UNIQUE`     | Clause | Removed | Running such queries will fall back to using Cypher 3.1 (and use the rule planner)
| `START`     | Clause | Removed | Running such queries will fall back to using Cypher 3.1 (and use the rule planner)
| `MATCH (n)-[rs*]-() RETURN rs`     | Syntax | Deprecated | Replaced by `MATCH p=(n)-[*]-() RETURN relationships(p) AS rs`
| `MATCH (n)-[:A\|:B\|:C {foo: 'bar'}]-() RETURN n`     | Syntax | Deprecated | Replaced by `MATCH (n)-[:A\|B\|C {foo: 'bar'}]-() RETURN n`
| `MATCH (n)-[x:A\|:B\|:C]-() RETURN n`     | Syntax | Deprecated | Replaced by `MATCH (n)-[x:A\|B\|C]-() RETURN n`
| `MATCH (n)-[x:A\|:B\|:C*]-() RETURN n`     | Syntax | Deprecated | Replaced by `MATCH (n)-[x:A\|B\|C*]-() RETURN n`
| link:{neo4j-docs-base-uri}/java-reference/{page-version}/extending-neo4j/aggregation-functions#extending-neo4j-aggregation-functions[User-defined aggregation functions] | Functionality | Added |
| xref:schema/indexes.adoc#query-schema-index-introduction[Composite indexes] | Index | Added |
| xref:schema/constraints.adoc#query-constraint-node-key[Node Key] | Index | Added | Neo4j Enterprise Edition only
| `CYPHER runtime=compiled` (Compiled runtime) | Functionality | Added | Neo4j Enterprise Edition only
| xref:functions/list.adoc#functions-reverse-list[reverse()] | Function  | Extended | Now also allows a list as input
| xref:functions/aggregating.adoc#functions-max[max()], xref:functions/aggregating.adoc#functions-min[min()] | Function  | Extended | Now also supports aggregation over a set containing both strings and numbers
|===


[[cypher-deprecations-additions-removals-3.3]]
=== Version 3.3
[options="header"]
|===
| Feature          | Type | Change | Details
| `START`          | Clause | Removed | As in Cypher 3.2, any queries using the `START` clause will revert back to Cypher 3.1 `planner=rule`.
However, there are xref:schema/indexes.adoc#explicit-indexes-procedures[built-in procedures] for accessing explicit indexes that will enable users to use the current version of Cypher and the cost planner together with these indexes.
An example of this is `CALL db.index.explicit.searchNodes('my_index','email:me*')`.
| `CYPHER runtime=slotted` (Faster interpreted runtime) | Functionality | Added | Neo4j Enterprise Edition only
| xref:functions/aggregating.adoc#functions-max[max()], xref:functions/aggregating.adoc#functions-min[min()] | Function  | Extended | Now also supports aggregation over sets containing lists of strings and/or numbers, as well as over sets containing strings, numbers, and lists of strings and/or numbers
|===

[[cypher-deprecations-additions-removals-3.4]]
=== Version 3.4
[options="header"]
|===
| Feature          | Type | Change | Details
| xref:syntax/spatial.adoc[Spatial point types] | Functionality | Amendment | A point -- irrespective of which Coordinate Reference System is used -- can be stored as a property and is able to be backed by an index. Prior to this, a point was a virtual property only.
| xref:functions/spatial.adoc#functions-point-cartesian-3d[point() - Cartesian 3D] | Function | Added |
| xref:functions/spatial.adoc#functions-point-wgs84-3d[point() - WGS 84 3D] | Function | Added |
| xref:functions/scalar.adoc#functions-randomuuid[randomUUID()] | Function | Added |
| xref:syntax/temporal.adoc[Temporal types]  | Functionality | Added | Supports storing, indexing and working with the following temporal types: Date, Time, LocalTime, DateTime, LocalDateTime and Duration.
| xref:functions/temporal/index.adoc[Temporal functions]  | Functionality | Added | Functions allowing for the creation and manipulation of values for each temporal type -- _Date_, _Time_, _LocalTime_, _DateTime_, _LocalDateTime_ and _Duration_.
| xref:syntax/operators.adoc#query-operators-temporal[Temporal operators]  | Functionality | Added | Operators allowing for the manipulation of values for each temporal type -- _Date_, _Time_, _LocalTime_, _DateTime_, _LocalDateTime_ and _Duration_.
|  xref:functions/string.adoc#functions-tostring[toString()]   | Function  | Extended | Now also allows temporal values as input (i.e. values of type _Date_, _Time_, _LocalTime_, _DateTime_, _LocalDateTime_ or _Duration_).
|===

[[cypher-deprecations-additions-removals-3.5]]
=== Version 3.5
[options="header"]
|===
| Feature          | Type | Change | Details
| `CYPHER runtime=compiled` (Compiled runtime)    | Functionality | Deprecated | The compiled runtime will be discontinued in the next major release. It might still be used for default queries in order to not cause regressions, but explicitly requesting it will not be possible.
| `extract()`   | Function  | Deprecated | Replaced by xref:syntax/lists.adoc#cypher-list-comprehension[list comprehension]
| `filter()`   | Function  | Deprecated | Replaced by xref:syntax/lists.adoc#cypher-list-comprehension[list comprehension]
|===

[[cypher-compatibility]]
== Compatibility

Older versions of the language can still be accessed if required.
There are two ways to select which version to use in queries.

. Setting a version for all queries:
You can configure your database with the configuration parameter `cypher.default_language_version`, and enter which version you'd like to use (see xref:deprecations-additions-removals-compatibility.adoc#cypher-versions[]).
Every Cypher query will use this version, provided the query hasn't explicitly been configured as described in the next item below.

. Setting a version on a query by query basis:
The other method is to set the version for a particular query.
Prepending a query with `CYPHER 2.3` will execute the query with the version of Cypher included in Neo4j 2.3.

Below is an example using the `has()` function:

[source, cypher]
----
CYPHER 2.3
MATCH (n:Person)
WHERE has(n.age)
RETURN n.name, n.age
----


[[cypher-versions]]
== Supported language versions

Neo4j 3.5 supports the following versions of the Cypher language:

* Neo4j Cypher 3.5
* Neo4j Cypher 3.4
* Neo4j Cypher 2.3

[TIP]
Each release of Neo4j supports a limited number of old Cypher Language Versions.
When you upgrade to a new release of Neo4j, please make sure that it supports the Cypher language version you need.
If not, you may need to modify your queries to work with a newer Cypher language version.
