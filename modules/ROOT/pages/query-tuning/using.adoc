[[query-using]]
= Planner hints and the USING keyword
:description: A planner hint is used to influence the decisions of the planner when building an execution plan for a query. Planner hints are specified in a query with the `USING` keyword. 

[CAUTION]
====
Forcing planner behavior is an advanced feature, and should be used with caution by experienced developers and/or database administrators only, as it may cause queries to perform poorly.


====

* xref:query-tuning/using.adoc#query-using-introduction[Introduction]
* xref:query-tuning/using.adoc#query-using-index-hint[Index hints]
* xref:query-tuning/using.adoc#query-using-scan-hint[Scan hints]
* xref:query-tuning/using.adoc#query-using-join-hint[Join hints]
* xref:query-tuning/using.adoc#query-using-periodic-commit-hint[`PERIODIC COMMIT` query hint]

[[query-using-introduction]]
== Introduction

When executing a query, Neo4j needs to decide where in the query graph to start matching.
This is done by looking at the `MATCH` clause and the `WHERE` conditions and using that information to find useful indexes, or other starting points.

However, the selected index might not always be the best choice.
Sometimes multiple indexes are possible candidates, and the query planner picks the suboptimal one from a performance point of view.
Moreover, in some circumstances (albeit rarely) it is better not to use an index at all.

Neo4j can be forced to use a specific starting point through the `USING` keyword. This is called giving a planner hint.
There are four types of planner hints: index hints, scan hints, join hints, and the `PERIODIC COMMIT` query hint.

[NOTE]
====
You cannot use planner hints if your query has a `START` clause.


====

The following graph is used for the examples below:

.Graph
["dot", "Planner hints and the USING keyword-1.svg", "neoviz", ""]
----
  N0 [
    label = "{Scientist|name = \'Liskov\'\lborn = 1939\l}"
  ]
  N0 -> N2 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N0 -> N1 [
    color = "#4e9a06"
    fontcolor = "#4e9a06"
    label = "KNOWS\n"
  ]
  N1 [
    label = "{Scientist|name = \'Wing\'\lborn = 1956\l}"
  ]
  N1 -> N4 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N1 -> N2 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N2 [
    label = "{Science|name = \'Computer Science\'\l}"
  ]
  N3 [
    label = "{Scientist|name = \'Conway\'\lborn = 1938\l}"
  ]
  N3 -> N2 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N4 [
    label = "{Science|name = \'Engineering\'\l}"
  ]
  N5 [
    label = "{Science|name = \'Chemistry\'\l}"
  ]
  N6 [
    label = "{Scientist|name = \'Curie\'\lborn = 1867\l}"
  ]
  N6 -> N5 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N7 [
    label = "{Scientist|name = \'Arden\'\l}"
  ]
  N7 -> N5 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N8 [
    label = "{Scientist|name = \'Franklin\'\l}"
  ]
  N8 -> N5 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]
  N9 [
    label = "{Scientist|name = \'Harrison\'\l}"
  ]
  N9 -> N5 [
    color = "#2e3436"
    fontcolor = "#2e3436"
    label = "RESEARCHED\n"
  ]

----
 


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(conway:Scientist { name: 'Conway' })
RETURN 1 AS column
----

The following query will be used in some of the examples on this page. It has intentionally been constructed in
such a way that the statistical information will be inaccurate for the particular subgraph that this query
matches. For this reason, it can be improved by supplying planner hints.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| Operator        | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                         | Other                                                                          |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +ProduceResults |              0 |    1 |       0 |               5 |                 1 |               0.8333 |     0.129 | liskov.name ASC | anon[126], anon[43], anon[70], column, conway, cs, liskov, wing   |                                                                                |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Projection     |              0 |    1 |       0 |               5 |                 1 |               0.8333 |     0.133 | liskov.name ASC | column -- anon[126], anon[43], anon[70], conway, cs, liskov, wing | {column : $`  AUTOINT3`}                                                       |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    6 |       5 |              15 |                 3 |               0.8333 |     0.152 | liskov.name ASC | anon[126], anon[43], anon[70], conway, cs, liskov, wing           | conway:Scientist; not `anon[126]` = `anon[70]`; conway.name = $`  AUTOSTRING2` |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    3 |       4 |               5 |                 1 |               0.8333 |     0.181 | liskov.name ASC | anon[126], conway -- anon[43], anon[70], cs, liskov, wing         | (cs)<-[:RESEARCHED]-(conway)                                                   |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    3 |       4 |               9 |                 2 |               0.8182 |     0.295 | liskov.name ASC | anon[43], anon[70], cs, liskov, wing                              | cs:Science; cs.name = $`  AUTOSTRING1`                                         |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    2 |       3 |               5 |                 1 |               0.8333 |     0.328 | liskov.name ASC | anon[70], cs -- anon[43], liskov, wing                            | (wing)-[:RESEARCHED]->(cs)                                                     |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    1 |       1 |               5 |                 1 |               0.8333 |     0.345 | liskov.name ASC | anon[43], liskov, wing                                            | wing:Scientist                                                                 |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    1 |       2 |               5 |                 1 |               0.8333 |     0.470 | liskov.name ASC | anon[43], wing -- liskov                                          | (liskov)-[:KNOWS]->(wing)                                                      |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +NodeIndexSeek  |              1 |    1 |       2 |               5 |                 1 |               0.8333 |     1.503 | liskov.name ASC | liskov                                                            | :Scientist(name)                                                               |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+

Total database accesses: 21

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway'}) RETURN 1 AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[query-using-index-hint]]
== Index hints

Index hints are used to specify which index, if any, the planner should use as a starting point.
This can be beneficial in cases where the index statistics are not accurate for the specific values that
the query at hand is known to use, which would result in the planner picking a non-optimal index.
To supply an index hint, use `USING INDEX variable:Label(property)` or `USING INDEX SEEK variable:Label(property)` after the applicable `MATCH` clause.

It is possible to supply several index hints, but keep in mind that several starting points
will require the use of a potentially expensive join later in the query plan.

=== Query using an index hint

The query above will not naturally pick an index to solve the plan.
This is because the graph is very small, and label scans are faster for small databases.
In general, however, query performance is ranked by the dbhit metric, and we see that using an index is
slightly better for this query.


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(conway:Scientist { name: 'Conway' })
USING INDEX liskov:Scientist(name)
RETURN liskov.born AS column
----

Returns the year *'Barbara Liskov'* was born.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| Operator        | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                         | Other                                                                          |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +ProduceResults |              0 |    1 |       0 |               6 |                 0 |               1.0000 |     0.084 | liskov.name ASC | anon[126], anon[43], anon[70], column, conway, cs, liskov, wing   |                                                                                |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Projection     |              0 |    1 |       1 |               6 |                 0 |               1.0000 |     0.091 | liskov.name ASC | column -- anon[126], anon[43], anon[70], conway, cs, liskov, wing | {column : liskov.born}                                                         |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    6 |       5 |              18 |                 0 |               1.0000 |     0.117 | liskov.name ASC | anon[126], anon[43], anon[70], conway, cs, liskov, wing           | conway:Scientist; not `anon[126]` = `anon[70]`; conway.name = $`  AUTOSTRING2` |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    3 |       4 |               6 |                 0 |               1.0000 |     0.592 | liskov.name ASC | anon[126], conway -- anon[43], anon[70], cs, liskov, wing         | (cs)<-[:RESEARCHED]-(conway)                                                   |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    3 |       4 |              11 |                 0 |               1.0000 |     0.706 | liskov.name ASC | anon[43], anon[70], cs, liskov, wing                              | cs:Science; cs.name = $`  AUTOSTRING1`                                         |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    2 |       3 |               6 |                 0 |               1.0000 |     0.725 | liskov.name ASC | anon[70], cs -- anon[43], liskov, wing                            | (wing)-[:RESEARCHED]->(cs)                                                     |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    1 |       1 |               6 |                 0 |               1.0000 |     0.740 | liskov.name ASC | anon[43], liskov, wing                                            | wing:Scientist                                                                 |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    1 |       2 |               6 |                 0 |               1.0000 |     0.855 | liskov.name ASC | anon[43], wing -- liskov                                          | (liskov)-[:KNOWS]->(wing)                                                      |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +NodeIndexSeek  |              1 |    1 |       2 |               6 |                 0 |               1.0000 |     1.104 | liskov.name ASC | liskov                                                            | :Scientist(name)                                                               |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+

Total database accesses: 22

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway'}) USING INDEX liskov:Scientist(name) RETURN liskov.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

=== Query using an index seek hint

Similar to the index (scan) hint, but an index seek will be used rather than an index scan.
Index seeks require no post filtering, they are most efficient when a relatively small number of nodes have the specified value on the queried property.


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(conway:Scientist { name: 'Conway' })
USING INDEX SEEK liskov:Scientist(name)
RETURN liskov.born AS column
----

Returns the year *'Barbara Liskov'* was born.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| Operator        | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                         | Other                                                                          |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +ProduceResults |              0 |    1 |       0 |               6 |                 0 |               1.0000 |     0.089 | liskov.name ASC | anon[126], anon[43], anon[70], column, conway, cs, liskov, wing   |                                                                                |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Projection     |              0 |    1 |       1 |               6 |                 0 |               1.0000 |     0.097 | liskov.name ASC | column -- anon[126], anon[43], anon[70], conway, cs, liskov, wing | {column : liskov.born}                                                         |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    6 |       5 |              18 |                 0 |               1.0000 |     0.116 | liskov.name ASC | anon[126], anon[43], anon[70], conway, cs, liskov, wing           | conway:Scientist; not `anon[126]` = `anon[70]`; conway.name = $`  AUTOSTRING2` |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    3 |       4 |               6 |                 0 |               1.0000 |     0.144 | liskov.name ASC | anon[126], conway -- anon[43], anon[70], cs, liskov, wing         | (cs)<-[:RESEARCHED]-(conway)                                                   |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    3 |       4 |              11 |                 0 |               1.0000 |     0.263 | liskov.name ASC | anon[43], anon[70], cs, liskov, wing                              | cs:Science; cs.name = $`  AUTOSTRING1`                                         |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    2 |       3 |               6 |                 0 |               1.0000 |     0.283 | liskov.name ASC | anon[70], cs -- anon[43], liskov, wing                            | (wing)-[:RESEARCHED]->(cs)                                                     |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Filter         |              0 |    1 |       1 |               6 |                 0 |               1.0000 |     0.298 | liskov.name ASC | anon[43], liskov, wing                                            | wing:Scientist                                                                 |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +Expand(All)    |              0 |    1 |       2 |               6 |                 0 |               1.0000 |     0.419 | liskov.name ASC | anon[43], wing -- liskov                                          | (liskov)-[:KNOWS]->(wing)                                                      |
| |               +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+
| +NodeIndexSeek  |              1 |    1 |       2 |               6 |                 0 |               1.0000 |     0.658 | liskov.name ASC | liskov                                                            | :Scientist(name)                                                               |
+-----------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+--------------------------------------------------------------------------------+

Total database accesses: 22

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway'}) USING INDEX SEEK liskov:Scientist(name) RETURN liskov.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

=== Query using multiple index hints

Supplying one index hint changed the starting point of the query, but the plan is still linear, meaning it
only has one starting point. If we give the planner yet another index hint, we force it to use two starting points,
one at each end of the match. It will then join these two branches using a join operator. 


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(conway:Scientist { name: 'Conway' })
USING INDEX liskov:Scientist(name)
USING INDEX conway:Scientist(name)
RETURN liskov.born AS column
----

Returns the year *'Barbara Liskov'* was born, using a slightly better plan.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| Operator            | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                         | Other                                  |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +ProduceResults     |              0 |    1 |       0 |               7 |                 1 |               0.8750 |     0.091 | cs.name ASC     | anon[126], anon[43], anon[70], column, conway, cs, liskov, wing   |                                        |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Projection         |              0 |    1 |       1 |               7 |                 1 |               0.8750 |     0.115 | cs.name ASC     | column -- anon[126], anon[43], anon[70], conway, cs, liskov, wing | {column : liskov.born}                 |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Filter             |              0 |    1 |       0 |               7 |                 1 |               0.8750 |     0.119 | cs.name ASC     | anon[126], anon[43], anon[70], conway, cs, liskov, wing           | not `anon[126]` = `anon[70]`           |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +NodeHashJoin       |              0 |    1 |       0 |              12 |                 1 |               0.9231 |     0.753 | cs.name ASC     | anon[43], anon[70], liskov, wing -- anon[126], conway, cs         | cs                                     |
| |\                  +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| | +Expand(Into)     |              0 |    1 |       2 |               7 |                 1 |               0.8750 |     1.236 | cs.name ASC     | anon[126] -- conway, cs                                           | (cs)<-[:RESEARCHED]-(conway)           |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| | +CartesianProduct |              1 |    1 |       0 |               7 |                 1 |               0.8750 |     1.239 | cs.name ASC     | cs -- conway                                                      |                                        |
| | |\                +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| | | +NodeIndexSeek  |              1 |    1 |       2 |               7 |                 1 |               0.8750 |     1.272 | conway.name ASC | conway                                                            | :Scientist(name)                       |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| | +NodeIndexSeek    |              1 |    1 |       2 |               7 |                 1 |               0.8750 |     1.354 | cs.name ASC     | cs                                                                | :Science(name)                         |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Filter             |              0 |    3 |       4 |              10 |                 0 |               1.0000 |     0.710 | liskov.name ASC | anon[43], anon[70], cs, liskov, wing                              | cs:Science; cs.name = $`  AUTOSTRING1` |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Expand(All)        |              0 |    2 |       3 |               5 |                 0 |               1.0000 |     0.739 | liskov.name ASC | anon[70], cs -- anon[43], liskov, wing                            | (wing)-[:RESEARCHED]->(cs)             |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Filter             |              0 |    1 |       1 |               5 |                 0 |               1.0000 |     0.754 | liskov.name ASC | anon[43], liskov, wing                                            | wing:Scientist                         |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +Expand(All)        |              0 |    1 |       2 |               5 |                 0 |               1.0000 |     0.877 | liskov.name ASC | anon[43], wing -- liskov                                          | (liskov)-[:KNOWS]->(wing)              |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+
| +NodeIndexSeek      |              1 |    1 |       2 |               5 |                 0 |               1.0000 |     1.229 | liskov.name ASC | liskov                                                            | :Scientist(name)                       |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+----------------------------------------+

Total database accesses: 19

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway'}) USING INDEX liskov:Scientist(name) USING INDEX conway:Scientist(name) RETURN liskov.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[query-using-scan-hint]]
== Scan hints

If your query matches large parts of an index, it might be faster to scan the label and filter out nodes that do not match.
To do this, you can use `USING SCAN variable:Label` after the applicable `MATCH` clause.
This will force Cypher to not use an index that could have been used, and instead do a label scan.

=== Hinting a label scan

If the best performance is to be had by scanning all nodes in a label and then filtering on that set, use `USING SCAN`.


.Query
[source, cypher]
----
MATCH (s:Scientist)
USING SCAN s:Scientist
WHERE s.born < 1939
RETURN s.born AS column
----

Returns all scientists born before *'1939'*.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime SLOTTED

Runtime version 3.5

+------------------+----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+
| Operator         | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Variables   | Other                  |
+------------------+----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+
| +ProduceResults  |              2 |    2 |       0 |               2 |                 0 |               1.0000 | column, s   |                        |
| |                +----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+
| +Projection      |              2 |    2 |       2 |               2 |                 0 |               1.0000 | column -- s | {column : s.born}      |
| |                +----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+
| +Filter          |              2 |    2 |       7 |               2 |                 0 |               1.0000 | s           | s.born < $`  AUTOINT0` |
| |                +----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+
| +NodeByLabelScan |              7 |    7 |       8 |               3 |                 0 |               1.0000 | s           | :Scientist             |
+------------------+----------------+------+---------+-----------------+-------------------+----------------------+-------------+------------------------+

Total database accesses: 17

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (s:Scientist)
USING SCAN s:Scientist
WHERE s.born < 1939
RETURN s.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[query-using-join-hint]]
== Join hints

Join hints are the most advanced type of hints, and are not used to find starting points for the
query execution plan, but to enforce that joins are made at specified points. This implies that there
has to be more than one starting point (leaf) in the plan, in order for the query to be able to join the two branches ascending
from these leaves. Due to this nature, joins, and subsequently join hints, will force
the planner to look for additional starting points, and in the case where there are no more good ones,
potentially pick a very bad starting point. This will negatively affect query performance. In other cases,
the hint might force the planner to pick a _seemingly_ bad starting point, which in reality proves to be a very good one.

=== Hinting a join on a single node

In the example above using multiple index hints, we saw that the planner chose to do a join on the `cs` node.
This means that the relationship between `wing` and `cs` was traversed in the outgoing direction, which is better
statistically because the pattern `()-[:RESEARCHED]->(:Science)` is more common than the pattern `(:Scientist)-[:RESEARCHED]->()`.
However, in the actual graph, the `cs` node only has two such relationships, so expanding from it will be beneficial
to expanding from the `wing` node. We can force the join to happen on `wing` instead with a join hint.


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(conway:Scientist { name: 'Conway' })
USING INDEX liskov:Scientist(name)
USING INDEX conway:Scientist(name)
USING JOIN ON wing
RETURN wing.born AS column
----

Returns the birth date of *'Jeanette Wing'*, using a slightly better plan.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| Operator            | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                         | Other                        |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +ProduceResults     |              0 |    1 |       0 |               8 |                 0 |               1.0000 |     0.100 | cs.name ASC     | anon[126], anon[43], anon[70], column, conway, cs, liskov, wing   |                              |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +Projection         |              0 |    1 |       1 |               8 |                 0 |               1.0000 |     0.173 | cs.name ASC     | column -- anon[126], anon[43], anon[70], conway, cs, liskov, wing | {column : wing.born}         |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +NodeHashJoin       |              0 |    1 |       0 |              18 |                 0 |               1.0000 |     0.838 | cs.name ASC     | anon[43], liskov -- anon[126], anon[70], conway, cs, wing         | wing                         |
| |\                  +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | +Filter           |              1 |    2 |       0 |              22 |                 0 |               1.0000 |     0.224 |                 | anon[126], anon[70], conway, cs, wing                             | not `anon[126]` = `anon[70]` |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | +Expand(All)      |              1 |    3 |       4 |               8 |                 0 |               1.0000 |     0.240 | cs.name ASC     | anon[70], wing -- anon[126], conway, cs                           | (cs)<-[:RESEARCHED]-(wing)   |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | +Expand(Into)     |              0 |    1 |       2 |               8 |                 0 |               1.0000 |     0.313 | cs.name ASC     | anon[126] -- conway, cs                                           | (cs)<-[:RESEARCHED]-(conway) |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | +CartesianProduct |              1 |    1 |       0 |               8 |                 0 |               1.0000 |     0.316 | cs.name ASC     | cs -- conway                                                      |                              |
| | |\                +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | | +NodeIndexSeek  |              1 |    1 |       2 |               8 |                 0 |               1.0000 |     0.350 | conway.name ASC | conway                                                            | :Scientist(name)             |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| | +NodeIndexSeek    |              1 |    1 |       2 |               8 |                 0 |               1.0000 |     0.427 | cs.name ASC     | cs                                                                | :Science(name)               |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +Filter             |              0 |    1 |       1 |               3 |                 0 |               1.0000 |     0.638 | liskov.name ASC | anon[43], liskov, wing                                            | wing:Scientist               |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +Expand(All)        |              0 |    1 |       2 |               3 |                 0 |               1.0000 |     0.757 | liskov.name ASC | anon[43], wing -- liskov                                          | (liskov)-[:KNOWS]->(wing)    |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+
| +NodeIndexSeek      |              1 |    1 |       2 |               3 |                 0 |               1.0000 |     1.008 | liskov.name ASC | liskov                                                            | :Scientist(name)             |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-------------------------------------------------------------------+------------------------------+

Total database accesses: 16

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist)-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway'})
USING INDEX liskov:Scientist(name)
USING INDEX conway:Scientist(name)
USING JOIN ON wing
RETURN wing.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

=== Hinting a join on multiple nodes

The query planner can be made to produce a join between several specific points. This requires the query to expand from the same node from several directions.


.Query
[source, cypher]
----
MATCH (liskov:Scientist { name:'Liskov' })-[:KNOWS]->(wing:Scientist { name:'Wing' })-[:RESEARCHED]->(cs:Science { name:'Computer Science' })<-[:RESEARCHED]-(liskov)
USING INDEX liskov:Scientist(name)
USING JOIN ON liskov, cs
RETURN wing.born AS column
----

Returns the birth date of *'Jeanette Wing'*.

.Query plan
[source]
----
Compiler CYPHER 3.5

Planner COST

Runtime COMPILED

Runtime version 3.5

+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| Operator            | Estimated Rows | Rows | DB Hits | Page Cache Hits | Page Cache Misses | Page Cache Hit Ratio | Time (ms) | Order           | Variables                                                 | Other                                        |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +ProduceResults     |              0 |    1 |       0 |               8 |                 0 |               1.0000 |     0.097 | cs.name ASC     | anon[142], anon[43], anon[86], column, cs, liskov, wing   |                                              |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Projection         |              0 |    1 |       1 |               8 |                 0 |               1.0000 |     0.118 | cs.name ASC     | column -- anon[142], anon[43], anon[86], cs, liskov, wing | {column : wing.born}                         |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Filter             |              0 |    1 |       0 |               8 |                 0 |               1.0000 |     0.121 | cs.name ASC     | anon[142], anon[43], anon[86], cs, liskov, wing           | not `anon[142]` = `anon[86]`                 |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +NodeHashJoin       |              0 |    1 |       0 |              13 |                 0 |               1.0000 |     0.849 | cs.name ASC     | anon[43], anon[86], wing -- anon[142], cs, liskov         | liskov, cs                                   |
| |\                  +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| | +Expand(Into)     |              0 |    1 |       2 |               8 |                 0 |               1.0000 |     0.332 | cs.name ASC     | anon[142] -- cs, liskov                                   | (cs)<-[:RESEARCHED]-(liskov)                 |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| | +CartesianProduct |              1 |    1 |       0 |               8 |                 0 |               1.0000 |     0.335 | cs.name ASC     | cs -- liskov                                              |                                              |
| | |\                +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| | | +NodeIndexSeek  |              1 |    1 |       2 |               8 |                 0 |               1.0000 |     0.369 | liskov.name ASC | liskov                                                    | :Scientist(name)                             |
| | |                 +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| | +NodeIndexSeek    |              1 |    1 |       2 |               8 |                 0 |               1.0000 |     0.445 | cs.name ASC     | cs                                                        | :Science(name)                               |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Filter             |              0 |    3 |       4 |              10 |                 0 |               1.0000 |     0.682 | liskov.name ASC | anon[43], anon[86], cs, liskov, wing                      | cs:Science; cs.name = $`  AUTOSTRING2`       |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Expand(All)        |              0 |    2 |       3 |               5 |                 0 |               1.0000 |     0.719 | liskov.name ASC | anon[86], cs -- anon[43], liskov, wing                    | (wing)-[:RESEARCHED]->(cs)                   |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Filter             |              0 |    2 |       2 |               5 |                 0 |               1.0000 |     0.917 | liskov.name ASC | anon[43], liskov, wing                                    | wing.name = $`  AUTOSTRING1`; wing:Scientist |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +Expand(All)        |              0 |    1 |       2 |               5 |                 0 |               1.0000 |     1.038 | liskov.name ASC | anon[43], wing -- liskov                                  | (liskov)-[:KNOWS]->(wing)                    |
| |                   +----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+
| +NodeIndexSeek      |              1 |    1 |       2 |               5 |                 0 |               1.0000 |     1.307 | liskov.name ASC | liskov                                                    | :Scientist(name)                             |
+---------------------+----------------+------+---------+-----------------+-------------------+----------------------+-----------+-----------------+-----------------------------------------------------------+----------------------------------------------+

Total database accesses: 20

----

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE INDEX ON :Scientist(name)
CREATE INDEX ON :Science(name)
CREATE
(liskov:Scientist {name: 'Liskov', born: 1939})-[:KNOWS]->(wing:Scientist {name: 'Wing', born: 1956})-[:RESEARCHED]->(cs:Science {name: 'Computer Science'})<-[:RESEARCHED]-(conway:Scientist {name: 'Conway', born: 1938}),
(liskov)-[:RESEARCHED]->(cs),
(wing)-[:RESEARCHED]->(:Science {name: 'Engineering'}),
(chemistry:Science {name: 'Chemistry'})<-[:RESEARCHED]-(:Scientist {name: 'Curie', born: 1867}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Arden'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Franklin'}),
(chemistry)<-[:RESEARCHED]-(:Scientist {name: 'Harrison'})
      

]]></database><command><![CDATA[
MATCH (liskov:Scientist {name:'Liskov'})-[:KNOWS]->(wing:Scientist {name:'Wing'})-[:RESEARCHED]->(cs:Science {name:'Computer Science'})<-[:RESEARCHED]-(liskov)
USING INDEX liskov:Scientist(name)
USING JOIN ON liskov, cs
RETURN wing.born AS column
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[[query-using-periodic-commit-hint]]
== `PERIODIC COMMIT` query hint

[NOTE]
====
See link:{neo4j-docs-base-uri}/getting-started/{page-version}/cypher-intro/load-csv#cypher-intro-load-csv[Import data] on how to import data from CSV files.


====

Importing large amounts of data using `LOAD CSV` with a single Cypher query may fail due to memory constraints.
This will manifest itself as an `OutOfMemoryError`.

For this situation _only,_ Cypher provides the global `USING PERIODIC COMMIT` query hint for updating queries using `LOAD CSV`.
If required, the limit for the number of rows per commit may be set as follows: `USING PERIODIC COMMIT 500`.

`PERIODIC COMMIT` will process the rows until the number of rows reaches a limit.
Then the current transaction will be committed and replaced with a newly opened transaction.
If no limit is set, a default value will be used.

See xref:clauses/load-csv.adoc#load-csv-importing-large-amounts-of-data[] in xref:clauses/load-csv.adoc[] for examples of `USING PERIODIC COMMIT` with and without setting the number of rows per commit.

[IMPORTANT]
====
Using `PERIODIC COMMIT` will prevent running out of memory when importing large amounts of data.
However, it will also break transactional isolation and thus it should only be used where needed.


====

