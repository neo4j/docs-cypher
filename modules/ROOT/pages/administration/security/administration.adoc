[[administration-security-administration]]
= Security of administration
:description: This section explains how to use Cypher to manage Neo4j administrative privileges.  This section explains how to use Cypher to manage privileges for Neo4j database administrative rights. 

All of the commands described in the enclosing xref:administration/index.adoc[Administration] section require that the user executing the commands has the rights to do so.
These privileges can be conferred either by granting the user the `admin` role, which enables all administrative rights, or by granting specific combinations of privileges.


* xref:administration/security/administration.adoc#administration-security-administration-introduction[The `admin` role]
* xref:administration/security/administration.adoc#administration-security-administration-database-privileges[Database administration]
** xref:administration/security/administration.adoc#administration-security-administration-database-access[The database `ACCESS` privilege]
** xref:administration/security/administration.adoc#administration-security-administration-database-startstop[The database `START`/`STOP` privileges]
** xref:administration/security/administration.adoc#administration-security-administration-database-indexes[The `INDEX MANAGEMENT` privileges]
** xref:administration/security/administration.adoc#administration-security-administration-database-constraints[The `CONSTRAINT MANAGEMENT` privileges]
** xref:administration/security/administration.adoc#administration-security-administration-database-tokens[The `NAME MANAGEMENT` privileges]
** xref:administration/security/administration.adoc#administration-security-administration-database-all[Granting all database administration privileges]
* xref:administration/security/administration.adoc#administration-security-administration-dbms-privileges[DBMS administration]
** xref:administration/security/administration.adoc#administration-security-administration-dbms-custom[Using a custom role to manage DBMS privileges]
** xref:administration/security/administration.adoc#administration-security-administration-dbms-privileges-role-management[The dbms `ROLE MANAGEMENT` privileges]


[role=enterprise-edition]
[[administration-security-administration-introduction]]
== The `admin` role

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/admin-role-introduction.asciidoc[]
// tag::include-neo4j-documentation[]
The built-in role `admin` includes a number of privileges allowing users granted this role the ability to perform administrative tasks.
These include the rights to perform the following classes of tasks:

* Manage xref:administration/security/administration.adoc#administration-security-administration-database-privileges[database security] for controlling the rights to perform actions on specific databases:
** Manage access to a database and the right to start and stop a database
** Manage xref:administration/indexes-for-search-performance.adoc[indexes] and xref:administration/constraints.adoc[constraints]
** Allow the creation of labels, relationship types or property names
* Manage xref:administration/security/administration.adoc#administration-security-administration-dbms-privileges[DBMS security] for controlling the rights to perform actions on the entire system:
** Manage xref:administration/databases.adoc[multiple databases]
** Manage xref:administration/security/users-and-roles.adoc[users and roles]
** Change configuration parameters
** Manage transactions
** Manage sub-graph privileges
** Manage procedure security

These rights are conferred using privileges that can be  managed using `GRANT`, `DENY` and `REVOKE` commands,
with the exception of the _DBMS Security_ privileges which are only available within the built-in `admin` role.
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/admin-role-introduction.asciidoc[]


.Query
[source, cypher]
----
SHOW ROLE admin PRIVILEGES
----

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"read"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"admin"+
| +"GRANTED"+ | +"write"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"admin"+
| +"GRANTED"+ | +"traverse"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"admin"+
| +"GRANTED"+ | +"read"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"admin"+
| +"GRANTED"+ | +"write"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"admin"+
| +"GRANTED"+ | +"traverse"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"admin"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"admin"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"schema"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
| +"GRANTED"+ | +"token"+ | +"database"+ | +"*"+ | +"database"+ | +"admin"+
6+d|Rows: 10
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE admin PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

If the built-in admin role has been altered or dropped, and needs to be restored to its original state, see link:{neo4j-docs-base-uri}/operations-manual/{page-version}/configuration/password-and-user-recovery[Operations Manual -> Password and user recovery].

[role=enterprise-edition]
[[administration-security-administration-database-privileges]]
== Database administration

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/admin-role-database.asciidoc[]
// tag::include-neo4j-documentation[]
As described in the section on xref:administration/security/subgraph.adoc[sub-graph security], the `GRANT` command allows an administrator to grant a privilege to a role in order to access an entity.
The `DENY` command allows an administrator to deny a privilege to a role in order to prevent access to an entity.
The `REVOKE` command allows an administrator to remove a previously granted or denied privilege.
The syntax is:

.General database privilege command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT database-privilege ON DATABASE[S] {* \| name} TO role[, ...]
| Grant a privilege to one or multiple roles

| [source, cypher, role=noplay]
DENY database-privilege ON DATABASE[S] {* \| name} TO role[, ...]
| Deny a privilege to one or multiple roles

| [source, cypher, role=noplay]
REVOKE GRANT database-privilege ON DATABASE[S] {* \| name} FROM role[, ...]
| Revoke a granted privilege from one or multiple roles

| [source, cypher, role=noplay]
REVOKE DENY database-privilege ON DATABASE[S] {* \| name} FROM role[, ...]
| Revoke a denied privilege from one or multiple roles

| [source, cypher, role=noplay]
REVOKE database-privilege ON DATABASE[S] {* \| name} FROM role[, ...]
| Revoke a granted or denied privilege from one or multiple roles
|===

Where the components are:

* _database-privilege_
** `ACCESS`
+
allows access for a specific database/graph
+
** `START`
+
allows the specified database to be started
+
** `STOP`
+
allows the specified database to be stopped
+
** `CREATE INDEX`
+
allows indexes to be created on the specified database.
+
** `DROP INDEX`
+
allows indexes to be deleted on the specified database.
+
** `INDEX [MANAGEMENT]`
+
allows indexes to be created and deleted on the specified database.
+
** `CREATE CONSTRAINT`
+
allows constraints to be created on the specified database.
+
** `DROP CONSTRAINT`
+
allows constraints to be deleted on the specified database.
+
** `CONSTRAINT [MANAGEMENT]`
+
allows constraints to be created and deleted on the specified database.
+
** `CREATE NEW [NODE] LABEL`
+
allows labels to be created so that future nodes can be assigned them.
+
** `CREATE NEW [RELATIONSHIP] TYPE`
+
allows relationship types to be created so that future relationships can be created with these types.
+
** `CREATE NEW [PROPERTY] NAME`
+
allows property names to be created so that nodes and relationships can have properties with these names assigned.
+
** `NAME [MANAGEMENT]`
+
allows all of the name management capabilities: node labels, relationship types and property names.
+
** `ALL [[DATABASE] PRIVILEGES]`
+
allows access, start, stop, index, constraint, and name management for the specified database.
+
* _name_
** The database to associate the privilege with.
   Note that if you delete a database and create a new one with the same name, the new one will NOT have any of the privileges specifically assigned to the deleted database.
** It can be `+*+` which means all databases.
  Any new databases created after this command will also be associated with these privileges.
* _role[, ...]_
** The role or roles to associate the privilege with, comma-separated.


NOTE: It is important to note that using DENY does NOT erase a GRANT command; they both exist.
The only way to erase a privilege is with REVOKE.
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/admin-role-database.asciidoc[]

The hierarchy between the different database privileges is shown in the image below.

image::privilege-hierarchy-database.png[title="Database privileges hierarchy"]

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/admin-database-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Database privilege command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT ACCESS
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Allow the specified role or roles to access the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT {START \| STOP}
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to start or stop the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT {CREATE \| DROP} INDEX[ES]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create or delete indexes on the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT INDEX[ES] [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create and delete indexes on the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT {CREATE \| DROP} CONSTRAINT[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create or delete indexes on the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT CONSTRAINT[S] [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create and delete constraints on the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT CREATE NEW [NODE] LABEL[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new labels for nodes in the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT CREATE NEW [RELATIONSHIP] TYPE[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new types for relationships in the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT CREATE NEW [PROPERTY] NAME[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new names for properties in the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT NAME [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new labels, relationship types and property names in the database `name` or all databases.

| [source, cypher, role=noplay]
GRANT ALL [[DATABASE] PRIVILEGES]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to access, start, and stop, as well as perform index, constraint, and name management on the database `name` or all databases.

|===
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/admin-database-syntax.asciidoc[]

image::grant-privileges-database.png[title="Syntax of GRANT and DENY Database Privileges"]

[role=enterprise-edition]
[[administration-security-administration-database-access]]
=== The database `ACCESS` privilege

The `ACCESS` privilege enables users to connect to a database.
With `ACCESS` you can run calculations, for example, `RETURN 2*5 AS answer` or call functions `RETURN timestamp() AS time`.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-access-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
GRANT ACCESS
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-access-syntax.asciidoc[]

For example, granting the ability to access the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT ACCESS ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT ACCESS ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The `ACCESS` privilege can also be denied.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-access-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
DENY ACCESS
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-access-syntax.asciidoc[]

For example, denying the ability to access to the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
DENY ACCESS ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY ACCESS ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The privileges granted can be seen using the `SHOW PRIVILEGES` command:


.Query
[source, cypher]
----
SHOW ROLE regularUsers PRIVILEGES
----

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 2
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE regularUsers PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[NOTE]
====
Only the `admin` role has access to execute the `SHOW PRIVILEGES` command.


====

[role=enterprise-edition]
[[administration-security-administration-database-startstop]]
=== The database `START`/`STOP` privileges

The `START` privilege can be used to enable the ability to start a database.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-start-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
GRANT START
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-start-syntax.asciidoc[]

For example, granting the ability to start the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT START ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT START ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The `START` privilege can also be denied.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-start-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
DENY START
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-start-syntax.asciidoc[]

For example, denying the ability to start to the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
DENY START ON DATABASE system TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY START ON DATABASE system TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The `STOP` privilege can be used to enable the ability to stop a database.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-stop-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
GRANT STOP
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/grant-database-stop-syntax.asciidoc[]

For example, granting the ability to stop the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT STOP ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT STOP ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The `STOP` privilege can also be denied.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-stop-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
DENY STOP
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/deny-database-stop-syntax.asciidoc[]

For example, denying the ability to stop to the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
DENY STOP ON DATABASE system TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY STOP ON DATABASE system TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The privileges granted can be seen using the `SHOW PRIVILEGES` command:


.Query
[source, cypher]
----
SHOW ROLE regularUsers PRIVILEGES
----

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"start_database"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"stop_database"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"DENIED"+ | +"start_database"+ | +"database"+ | +"system"+ | +"database"+ | +"regularUsers"+
| +"DENIED"+ | +"stop_database"+ | +"database"+ | +"system"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 6
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE regularUsers PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-database-indexes]]
=== The `INDEX MANAGEMENT` privileges

Indexes can be created or deleted with the `CREATE INDEX` and `DROP INDEX` commands.
The privilege to do this can be granted with `GRANT CREATE INDEX` and `GRANT DROP INDEX` commands.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/index-management-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Index management command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT {CREATE \| DROP} INDEX[ES]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create or delete indexes on the database `name` or all databases

| [source, cypher, role=noplay]
GRANT INDEX[ES] [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create and delete indexes on the database `name` or all databases

|===
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/index-management-syntax.asciidoc[]

For example, granting the ability to create indexes on the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT CREATE INDEX ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT CREATE INDEX ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-database-constraints]]
=== The `CONSTRAINT MANAGEMENT` privileges

Constraints can be created or deleted with the `CREATE CONSTRAINT` and `DROP CONSTRAINT` commands.
The privilege to do this can be granted with `GRANT CREATE CONSTRAINT` and `GRANT DROP CONSTRAINT` commands.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/constraint-management-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Constraint management command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT {CREATE \| DROP} CONSTRAINT[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create or delete constraints on the database `name` or all databases

| [source, cypher, role=noplay]
GRANT CONSTRAINT[S] [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create and delete constraints on the database `name` or all databases

|===
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/constraint-management-syntax.asciidoc[]

For example, granting the ability to create constraints on the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT CREATE CONSTRAINT ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT CREATE CONSTRAINT ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-database-tokens]]
=== The `NAME MANAGEMENT` privileges

The right to create new labels, relationship types, and property names is different from the right to create nodes, relationships, and properties.
The latter is managed using database `WRITE` privileges, while the former is managed using specific `GRANT/DENY CREATE NEW ...` commands for each type.

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/name-management-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Label, relationship type and property name management command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT CREATE NEW [NODE] LABEL[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new labels for nodes in the database `name` or all databases

| [source, cypher, role=noplay]
GRANT CREATE NEW [RELATIONSHIP] TYPE[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new types for relationships in the database `name` or all databases

| [source, cypher, role=noplay]
GRANT CREATE NEW [PROPERTY] NAME[S]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new names for properties in the database `name` or all databases

| [source, cypher, role=noplay]
GRANT NAME [MANAGEMENT]
    ON DATABASE[S] {* \| name}
    TO role[, ...]
| Enable the specified role or roles to create new labels, relationship types and property names in the database `name` or all databases

|===
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/name-management-syntax.asciidoc[]

For example, granting the ability to create new properties on nodes or relationships in the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT CREATE NEW PROPERTY NAME ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT CREATE NEW PROPERTY NAME ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-database-all]]
=== Granting all database administration privileges

Conferring the right to access, start, and stop, as well as perform index, constraint, and name management can be achieved with a single command:

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/database/all-management-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Command syntax
[source, cypher, role=noplay]
-----
GRANT ALL [[DATABASE] PRIVILEGES]
    ON DATABASE[S] {* | name}
    TO role[, ...]
-----
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/database/all-management-syntax.asciidoc[]

For example, granting the ability to access, start and stop all databases and create indexes, constraints, labels, relationship types and property names on the database `neo4j` to the role `regularUsers` is done using the following query.


.Query
[source, cypher]
----
GRANT ALL DATABASE PRIVILEGES ON DATABASE neo4j TO regularUsers
----

[role="statsonlyqueryresult"]
0 rows, System updates: 4

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT ALL DATABASE PRIVILEGES ON DATABASE neo4j TO regularUsers
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The privileges granted can be seen using the `SHOW PRIVILEGES` command:


.Query
[source, cypher]
----
SHOW ROLE regularUsers PRIVILEGES
----

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"DENIED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"create_constraint"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"create_index"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"create_label"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"create_propertykey"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"create_reltype"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"drop_constraint"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"drop_index"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"start_database"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"GRANTED"+ | +"stop_database"+ | +"database"+ | +"neo4j"+ | +"database"+ | +"regularUsers"+
| +"DENIED"+ | +"start_database"+ | +"database"+ | +"system"+ | +"database"+ | +"regularUsers"+
| +"DENIED"+ | +"stop_database"+ | +"database"+ | +"system"+ | +"database"+ | +"regularUsers"+
6+d|Rows: 13
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE regularUsers PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-dbms-privileges]]
== DBMS administration

All DBMS privileges are relevant system-wide. Like user management, they do not belong to one specific database or graph.
For more details on the differences between graphs, databases and the DBMS, refer to xref:introduction/neo4j-databases-graphs.adoc[].

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/admin-role-dbms.asciidoc[]
// tag::include-neo4j-documentation[]
As xref:administration/security/administration.adoc#administration-security-administration-introduction[described above], the `admin` role has a number of built-in privileges that cannot be assigned using Cypher commands.
These include:

* Create or drop databases
* Change configuration parameters
* Manage transactions
* Manage users and roles (role management by itself is assignable using xref:administration/security/administration.adoc#administration-security-administration-dbms-privileges-role-management[Cypher commands])
* Manage sub-graph privileges
* Manage procedure security

The easiest way to enable a user to perform these tasks is to grant them the `admin` role.
The only subset of these privileges that is assignable using Cypher commands is xref:administration/security/administration.adoc#administration-security-administration-dbms-privileges-role-management[role management].
However, it is possible to make a custom role with a subset of these privileges.
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/admin-role-dbms.asciidoc[]

[role=enterprise-edition]
[[administration-security-administration-dbms-custom]]
=== Using a custom role to manage DBMS privileges

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/admin-role-dbms-custom.asciidoc[]
// tag::include-neo4j-documentation[]
If it is desired to have an administrator with a subset of privileges that includes all DBMS privileges, but not all database privileges, this can be achieved by copying the `admin` role and revoking or denying some privileges.
// For example, let's assume we want an administrator that is able to perform user and role management, but cannot write to normal databases, or manage indexes or constraints.
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/admin-role-dbms-custom.asciidoc[]

First we copy the 'admin' role:


.Query
[source, cypher]
----
CREATE ROLE usermanager AS COPY OF admin
----

[role="statsonlyqueryresult"]
0 rows, System updates: 2

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
CREATE ROLE usermanager AS COPY OF admin
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

Then we DENY ACCESS to normal databases:


.Query
[source, cypher]
----
DENY ACCESS ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY ACCESS ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

And DENY START and STOP for normal databases:


.Query
[source, cypher]
----
DENY START ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY START ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]


.Query
[source, cypher]
----
DENY STOP ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY STOP ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

And DENY index and constraint management:


.Query
[source, cypher]
----
DENY INDEX MANAGEMENT ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 2

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY INDEX MANAGEMENT ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]


.Query
[source, cypher]
----
DENY CONSTRAINT MANAGEMENT ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 2

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY CONSTRAINT MANAGEMENT ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

And finally DENY label, relationship type and property name:


.Query
[source, cypher]
----
DENY NAME MANAGEMENT ON DATABASE * TO usermanager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 3

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
DENY NAME MANAGEMENT ON DATABASE * TO usermanager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow the DBMS capabilities, like user and role management:


.Query
[source, cypher]
----
SHOW ROLE usermanager PRIVILEGES
----

Lists all privileges for role 'usermanager'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"read"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"usermanager"+
| +"GRANTED"+ | +"write"+ | +"all_properties"+ | +"*"+ | +"NODE(*)"+ | +"usermanager"+
| +"GRANTED"+ | +"traverse"+ | +"graph"+ | +"*"+ | +"NODE(*)"+ | +"usermanager"+
| +"GRANTED"+ | +"read"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"usermanager"+
| +"GRANTED"+ | +"write"+ | +"all_properties"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"usermanager"+
| +"GRANTED"+ | +"traverse"+ | +"graph"+ | +"*"+ | +"RELATIONSHIP(*)"+ | +"usermanager"+
| +"DENIED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"GRANTED"+ | +"access"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"GRANTED"+ | +"admin"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"create_constraint"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"create_index"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"create_label"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"create_propertykey"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"create_reltype"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"drop_constraint"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"drop_index"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"GRANTED"+ | +"schema"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"start_database"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"DENIED"+ | +"stop_database"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
| +"GRANTED"+ | +"token"+ | +"database"+ | +"*"+ | +"database"+ | +"usermanager"+
6+d|Rows: 20
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE usermanager PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

[role=enterprise-edition]
[[administration-security-administration-dbms-privileges-role-management]]
=== The dbms `ROLE MANAGEMENT` privileges

The dbms privileges for role management are assignable using Cypher administrative commands. They can be granted, denied and revoked like other privileges.

image::privilege-hierarchy-dbms.png[title="Role management privileges hierarchy"]

// tag::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/role-management-syntax.asciidoc[]
// tag::include-neo4j-documentation[]
.Role management privileges command syntax
[options="header", width="100%", cols="3a,2"]
|===
| Command | Description

| [source, cypher, role=noplay]
GRANT CREATE ROLE
    ON DBMS
    TO role[, ...]
| Enable the specified role or roles to create new roles

| [source, cypher, role=noplay]
GRANT DROP ROLE
    ON DBMS
    TO role[, ...]
| Enable the specified role or roles to delete roles

| [source, cypher, role=noplay]
GRANT ASSIGN ROLE
    ON DBMS
    TO role[, ...]
| Enable the specified role or roles to assign roles to users

| [source, cypher, role=noplay]
GRANT REMOVE ROLE
    ON DBMS
    TO role[, ...]
| Enable the specified role or roles to remove roles from users

| [source, cypher, role=noplay]
GRANT SHOW ROLE
ON DBMS
TO role[, ...]
| Enable the specified role or roles to list roles

| [source, cypher, role=noplay]
GRANT ROLE MANAGEMENT
    ON DBMS
    TO role[, ...]
| Enable the specified role or roles to create, delete, assign, remove and list roles

|===

[NOTE]
Only the `admin` role has access to execute the `SHOW PRIVILEGES` command.
// end::include-neo4j-documentation[]
// end::neo4j-cypher-docs/docs/dev/ql/administration/security/dbms/role-management-syntax.asciidoc[]

The ability to add roles can be granted via the `CREATE ROLE` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT CREATE ROLE ON DBMS TO roleAdder
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT CREATE ROLE ON DBMS TO roleAdder
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow adding roles:


.Query
[source, cypher]
----
SHOW ROLE roleAdder PRIVILEGES
----

Lists all privileges for role 'roleAdder'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"create_role"+ | +"database"+ | +"*"+ | +"database"+ | +"roleAdder"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleAdder PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The ability to delete roles can be granted via the `DROP ROLE` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT DROP ROLE ON DBMS TO roleDropper
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT DROP ROLE ON DBMS TO roleDropper
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow deleting roles:


.Query
[source, cypher]
----
SHOW ROLE roleDropper PRIVILEGES
----

Lists all privileges for role 'roleDropper'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"drop_role"+ | +"database"+ | +"*"+ | +"database"+ | +"roleDropper"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleDropper PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The ability to assign roles to users can be granted via the `ASSIGN ROLE` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT ASSIGN ROLE ON DBMS TO roleAssigner
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT ASSIGN ROLE ON DBMS TO roleAssigner
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow assigning/granting roles:


.Query
[source, cypher]
----
SHOW ROLE roleAssigner PRIVILEGES
----

Lists all privileges for role 'roleAssigner'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"assign_role"+ | +"database"+ | +"*"+ | +"database"+ | +"roleAssigner"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleAssigner PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The ability to remove roles from users can be granted via the `REMOVE ROLE` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT REMOVE ROLE ON DBMS TO roleRemover
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT REMOVE ROLE ON DBMS TO roleRemover
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow removing/revoking roles:


.Query
[source, cypher]
----
SHOW ROLE roleRemover PRIVILEGES
----

Lists all privileges for role 'roleRemover'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"remove_role"+ | +"database"+ | +"*"+ | +"database"+ | +"roleRemover"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleRemover PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The ability to show roles can be granted via the `SHOW ROLE` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT SHOW ROLE ON DBMS TO roleShower
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT SHOW ROLE ON DBMS TO roleShower
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have privileges that only allow showing roles, _not privileges_:


.Query
[source, cypher]
----
SHOW ROLE roleShower PRIVILEGES
----

Lists all privileges for role 'roleShower'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"show_role"+ | +"database"+ | +"*"+ | +"database"+ | +"roleShower"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleShower PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The privileges to create, delete, assign, remove, and list roles can be granted via the `ROLE MANAGEMENT` privilege. The following query shows an example of this:


.Query
[source, cypher]
----
GRANT ROLE MANAGEMENT ON DBMS TO roleManager
----

[role="statsonlyqueryresult"]
0 rows, System updates: 1

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
GRANT ROLE MANAGEMENT ON DBMS TO roleManager
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

The resulting role should have all privileges to manage roles:


.Query
[source, cypher]
----
SHOW ROLE roleManager PRIVILEGES
----

Lists all privileges for role 'roleManager'

.Result
[role="queryresult",options="header,footer",cols="6*<m"]
|===
| +access+ | +action+ | +resource+ | +graph+ | +segment+ | +role+
| +"GRANTED"+ | +"role_management"+ | +"database"+ | +"*"+ | +"database"+ | +"roleManager"+
6+d|Rows: 1
|===

ifndef::nonhtmloutput[]
[subs="none"]
++++
<formalpara role="cypherconsole">
<title>Try this query live</title>
<para><database><![CDATA[
CREATE USER jake SET PASSWORD 'abc123' CHANGE NOT REQUIRED SET STATUS ACTIVE
CREATE ROLE regularUsers
CREATE ROLE noAccessUsers
CREATE ROLE roleAdder
CREATE ROLE roleDropper
CREATE ROLE roleAssigner
CREATE ROLE roleRemover
CREATE ROLE roleShower
CREATE ROLE roleManager
GRANT ROLE regularUsers TO jake
DENY ACCESS ON DATABASE neo4j TO noAccessUsers

]]></database><command><![CDATA[
SHOW ROLE roleManager PRIVILEGES
]]></command></para></formalpara>
++++
endif::nonhtmloutput[]

